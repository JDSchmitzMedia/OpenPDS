var Collection = require('deployd/lib/resources/collection');
var util = require('util');
var http = require('http');

function ProtectedResource(name, options) {
  Collection.apply(this, arguments);
}
ProtectedResource.external = Collection.external;

util.inherits(ProtectedResource, Collection);
module.exports = ProtectedResource;

ProtectedResource.prototype.handle = function (ctx, next) {
console.log('should call oauth');

var options = {
    host: 'celldata.media.mit.edu',
    port: 8041,
    path: '/get_key_from_token?bearer_token=e35ae8c3a8&scope=funf_write',
    method: 'GET'
  };

  var req = http.get(options, function(res) {
    var pageData = "";
    res.setEncoding('utf8');
    res.on('data', function (chunk) {
      pageData += chunk;
    });

    res.on('end', function(){
      console.log(pageData);
    });
  });

this.find(ctx, ctx.done);

}


ProtectedResource.dashboard = Collection.dashboard;
